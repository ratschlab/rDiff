<tool id="rdiffweb" name="rDiff">
  <description>Determines differentially expressed transcripts from read alignments</description>
  <command>~/bin/octave_start_script.sh
    "setup_mgene; galaxy_rdiff_web('$Annotation.extra_files_path',
    '$bam_alignments1', '$bam_alignments2',
    '$rdiff_out', '$test_meth');"
    >> $Log_File; ~/bin/cleanup_output.sh $Log_File</command>
  <inputs>
    <param format="gann" name="Annotation" type="data" label="Genome annotation" help="Genome annotation file in AGS format. Can be created with the GFF2Anno tool."/>
    <param format="bam" name="bam_alignments1" type="data" label="Sample 1 BAM alignment file" help="BAM alignment file. Can be generated from SAM files using the SAM Tools."/>
    <param format="bam" name="bam_alignments2" type="data" label="Sample 2 BAM alignment file" help="BAM alignment file. Can be generated from SAM files using the SAM Tools."/>
    <param name="test_meth" type="select" label="Testing method" help="Choose method for statistical test." >
      <option value="poisson_exp">Poisson-based differential gene expression</option>
      <option value="poisson">Poisson-based differential transcript expression</option>
      <option value="mmd">MMD-based differential transcript expression</option>
    </param>
  </inputs>

  <outputs>
    <data format="txt" name="rdiff_out" label="rDiff result"/>
    <data format="txt" name="Log_File" label="rDiff Log File"/>
  </outputs>
  <help>

.. class:: infomark

**What it does** 

`rDiff` is a tool for differential expression testing of RNA-Seq data.


**Inputs**

`rDiff` requires three input files to run:

1. The Genome Annotation Object, containing the necessary information about the transcripts that are to be quantified. It can be constructed using the `GFF2Anno` tool from an annotation in GFF3 format.
2. The BAM alignment file for sample 1, which stores the read alignments in a compressed format. It can be generated using the `SAM-to-BAM` tool in the NGS: SAM Tools section.
3. The BAM alignment file for sample 2, which stores the read alignments in a compressed format. It can be generated using the `SAM-to-BAM` tool in the NGS: SAM Tools section.

For the feature `Testing Method` you have two options:

1. "Gene-Poisson": Poisson test for detecting differential gene expression
2. "Transcript-Poisson": Poisson test for detecting differential transcript expression
3. "Transcript-MMD": Maximum Mean Discrepancy test for detecting differential transcript expression

**Output**

`rDiff` generates a text file containing the gene name, the name of the testing method and the p-value.

------

**Licenses**

If **rDiff.web** is used to obtain results for scientific publications it
should be cited as [1]_.

**References** 

.. [1] Stegle, O, Drewe, P, Bohnert, R, Borgwardt, K, and RÃ¤tsch, G (2010): `Statistical Tests for Detecting Differential RNA-Transcript Expression from Read Counts`_. Preprint.

.. _Statistical Tests for Detecting Differential RNA-Transcript Expression from Read Counts: http://precedings.nature.com/documents/4437/version/1

------


.. class:: infomark

**About formats**

**GIO format** Genome Information Object is an internal format used to
store relevant information about the genome under consideration (as
extracted from a FASTA file). It includes, for example, number and
length of chromosomes/contigs. The file is generated by applying the
`GenomeTool`.

**AGS format** Annotation Gene Structure Object is an internal
structure that efficiently stores the information from a GFF3 file. It
can be generated with the `GFF2Anno` tool.

**SAM/BAM format** The Sequence Alignment/Map (SAM) format is a
tab-limited text format that stores large nucleotide sequence
alignments. BAM is the binary version of a SAM file that allows for
fast and intensive data processing. The format specification and the
description of SAMtools can be found on
http://samtools.sourceforge.net/.


</help>
</tool>
